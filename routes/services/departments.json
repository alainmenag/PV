{
	"title": "Services / Departments",
	"description": "Start lining up.",

	"sections": [
		
		{
			"id": "list",
			"title": "Departments",
			"if": "session.profile.services['64891ebf55bedc996a21d632'].added",
			"template": "/templates/table.html",
			"src": "/api/data?collection=profiles&category=departments",
			"columns": [
				{
					"title": "",
					"data": "id",
					"format": "<a href=\"/@{{row._id}}\"><span class=\"handle\">{{row.id}}</span></a>",
					"searchable": true
				}
				, {
					"title": "Join",
					"align": "center",
					"data": "_id",
					"format": "<form system-form method=\"POST\" action=\"/api/services\" key=\"session.profile\"><input type=\"checkbox\" name=\"action\" ng-checked=\"session.profile.departments[row._id].added\" value=\"{{session.profile.departments[row._id].added ? 'remove' : 'add'}}\" onchange=\"event.target.form.submit(event);\" /><input type=\"hidden\" name=\"_id\" value=\"{{row._id}}\" /><input type=\"hidden\" name=\"category\" value=\"{{row.category}}\" /><input type=\"hidden\" name=\"uid\" value=\"{{session.uid}}\" /></form>",
					"searchable": false,
					"sortable": false
				},
				{
					"title": "Name",
					"data": "title",
					"searchable": true
				},
				{
					"title": "Members",
					"data": "members",
					"format": "{{row.members.length}}",
					"searchable": false,
					"sortable": false
				},
				{
					"title": "PIN",
					"data": "pin",
					"sortable": false
				}
			]
		}

		
		
		, {
			"id": "departments",
			"if": "session.profile.services['64891ebf55bedc996a21d632'].added",
			"template": "/templates/form.html",
			"title": "Add Department",
			"background": "#f2f2f2",
			"action": "/api/services/departments",
			"method": "POST",
			"reload": true,
			"reset": true,
			"_key": "session.profile",
			"data": {
				
				"uid": {
					"id": "uid",
					"value": "{{session.profile._id}}",
					"type": "hidden"
				},
				
				"access_token": {
					"id": "access_token",
					"value": "{{session.profile.password}}",
					"type": "hidden"
				},
				
				"title": {
					"required": false,
					"id": "name",
					"title": "Name",
					"type": "text",
					"autocomplete": false,
					"model": false
				},
				
				"pin": {
					"required": true,
					"id": "pin",
					"title": "Pin",
					"type": "number",
					"min": 100000,
					"help": "6 digit pin code to secure the department and for others to join.",
					"autocomplete": false,
					"model": false
				}
				
			}
		}
		


		, {
			"title": "Enable",
			"if": "session.uid && !session.profile.services['64891ebf55bedc996a21d632'].added",
			"template": "/templates/list.html",
			"data": [
				{
					"title": "<a href=\"/account\">Enable</a> to get started."
				}
			]
		}
		


		, {
			"title": "Access",
			"if": "!session.uid",
			"template": "/templates/list.html",
			"data": [
				{
					"title": "<a href=\"/access/login?redirect=%2Faccount\" target=\"_top\">Login</a> to get started."
				}
			]
		}
		
		
		
		
	],
	"resources": [
		
		{
			"src": "data.node",
			"fn": "list",
			"key": "list",
			"category": "departments",
			"collection": "profiles"
		}
		
	]
	
}
